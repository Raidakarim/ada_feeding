<root BTCPP_format="4" main_tree_to_execute="PartialPlateLocator" >
  <!-- Subtree Includes -->
  <include path="./helpers.xml" />

  <!-- Moving robot to locate plate -->
  <BehaviorTree ID="PartialPlateLocator">
    <Sequence name="root_sequence">
      <RetryNode N=30>
      <RosSubBool topic="/alert" target="{alert}" />

      <Precondition if="alert==False" else="FAILURE">
        <Sequence>
          <RosSubString topic="/locate" target="{locate}" />

          <Precondition if="locate==FORWARD" else="FAILURE">
            <Sequence>
              <!-- Go to forward: -10 cm-->
              <AdaPlanToOffset offset="0.00;-0.10;0.0" worldCollision="true" traj="{traj}" />
              <AdaExecuteTrajectory traj="{traj}" />
             </Sequence>
          </Precondition> 

          <Precondition elseif="locate==BACKWARD" else="FAILURE">
            <Sequence>
              <!-- Go to backward: 10 cm -->
              <AdaPlanToOffset offset="0.00;0.10;0.0" worldCollision="true" traj="{traj}" />
              <AdaExecuteTrajectory traj="{traj}" />
            </Sequence>
          </Precondition>

          <Precondition elseif="locate==LEFT" else="FAILURE">
            <Sequence>        
              <!-- Go to left: 10 cm -->
              <AdaPlanToOffset offset="0.10;0.00;0.0" worldCollision="true" traj="{traj}" />
              <AdaExecuteTrajectory traj="{traj}" />
            </Sequence>
          </Precondition> 

          <Precondition elseif="locate==RIGHT" else="FAILURE">
            <Sequence> 
              <!-- Go to right: 10 cm -->
              <AdaPlanToOffset offset="-0.10;0.00;0.0" worldCollision="true" traj="{traj}" />
              <AdaExecuteTrajectory traj="{traj}" />
            </Sequence>
          </Precondition>

        <Sequence>
      </Precondition>

      <RosSubVecD topic="/offset" target="{offset}" />
      <Precondition if="offset!=None" else="FAILURE">
        <Sequence>
          <AdaPlanToOffset offset="{offset}" worldCollision="true" traj="{traj}" />
          <AdaExecuteTrajectory traj="{traj}" />
        </Sequence>
      </Precondition>

    </Sequence>
  </BehaviorTree>
</root>
